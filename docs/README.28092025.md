–û—Ç–ª–∏—á–Ω–æ, —Ç–æ–≥–¥–∞ –¥–µ—Ä–∂–∏ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–Ω—ã–π **`README.md`** –±–µ–∑ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π, –≤ –¥—É—Ö–µ –ø—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏, –Ω–æ —Å —É—á—ë—Ç–æ–º –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π –∏ –Ω—é–∞–Ω—Å–æ–≤:

```markdown
# üìò Legal Assistant API ‚Äî v2 (–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞)

–ü—Ä–æ–µ–∫—Ç: **—Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ —é—Ä–∏—Å—Ç–∞ –ø–æ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–º –¥–µ–ª–∞–º**
–°—Ç–µ–∫: **Python 3.12 ¬∑ FastAPI ¬∑ SQLAlchemy 2 ¬∑ Pydantic v2 ¬∑ Alembic ¬∑ PostgreSQL (prod) ¬∑ SQLite (tests)**

---

## üî≠ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ú–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –∏ –ø—Ä–æ—Ü–µ—Å—Å—É–∞–ª—å–Ω–∞—è –±–∞–∑–∞** –ø–æ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–º —Å–ø–æ—Ä–∞–º (–Ω–æ—Ä–º—ã + –ø—Ä–∞–∫—Ç–∏–∫–∞).
2. **–†–µ–≥—É–ª—è—Ä–Ω–∞—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è** –ø—Ä–∞–≤–æ–≤–æ–π –±–∞–∑—ã.
3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞**.
4. **–ü—Ä–∞–≤–æ–≤–æ–π –∞–Ω–∞–ª–∏–∑** –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã (–∏–µ—Ä–∞—Ä—Ö–∏—è –Ω–æ—Ä–º –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏).
5. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ **–∫–æ–ª–ª–∏–∑–∏–π** –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é.
6. **–ú–æ—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** (–∫–∞–∂–¥—ã–π –≤—ã–≤–æ–¥ –æ–±–æ—Å–Ω–æ–≤–∞–Ω –Ω–æ—Ä–º–∞–º–∏/–ø—Ä–∞–∫—Ç–∏–∫–æ–π).
7. **–û—Ü–µ–Ω–∫–∞ —à–∞–Ω—Å–æ–≤ –≤ %** —Å –æ–ø–æ—Ä–æ–π –Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –ø—Ä–∞–∫—Ç–∏–∫—É.
8. **–°—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏** –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ —Å—É–¥–µ.
9. **–°–ø–∏—Å–æ–∫ –∏ —Ñ–æ—Ä–º—ã —Ç–∏–ø–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**.
10. **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** –ø–æ–º–æ—â–Ω–∏–∫–∞.
11. **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç–æ–∏–º–æ—Å—Ç–∏** (—Å –ø–æ–Ω–∏–∂–∞—é—â–µ-–ø–æ–≤—ã—à–∞—é—â–∏–º–∏ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏).
12. **–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** –ø–æ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—é –ø—Ä–∞–∫—Ç–∏–∫–∏ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –¥–µ–ª.

---

## üß≠ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã v2

- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å**: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è + CI + –º–∏–≥—Ä–∞—Ü–∏–∏ + —Ñ–∏–∫—Å–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: —Å–µ–∫—Ä–µ—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è/—Å–µ–∫—Ä–µ—Ç-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –ë–î.
- **–ß–∏—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**: —Å—Ç—Ä–æ–≥–∏–µ Pydantic-—Å—Ö–µ–º—ã (v2, `from_attributes=True`), –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫.
- **–ò–∑–æ–ª—è—Ü–∏—è —Å–ª–æ—ë–≤**: –≤–µ–±-—Ä–æ—É—Ç—ã / —Å–µ—Ä–≤–∏—Å—ã / –º–æ–¥–µ–ª–∏ / —Å—Ö–µ–º—ã —Ä–∞–∑–Ω–µ—Å–µ–Ω—ã.
- **SQLite –¥–ª—è —Ç–µ—Å—Ç–æ–≤**, PostgreSQL ‚Äî –≤ dev/prod.
- **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** –∏–∑ OpenAPI + –∞–≤—Ç–æ—Å–±–æ—Ä –≤ CI.
- **Makefile** ‚Äî —É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```

legal-assistant-arbitrage-v2/
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ alembic/              # –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ database.py
‚îÇ       ‚îú‚îÄ‚îÄ main.py
‚îÇ       ‚îú‚îÄ‚îÄ models.py
‚îÇ       ‚îú‚îÄ‚îÄ routes/           # health, users, laws, decisions
‚îÇ       ‚îú‚îÄ‚îÄ schemas/          # Pydantic-—Å—Ö–µ–º—ã
‚îÇ       ‚îú‚îÄ‚îÄ services/         # –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–Ω–∞ –±—É–¥—É—â–µ–µ)
‚îÇ       ‚îî‚îÄ‚îÄ tests/            # pytest
‚îú‚îÄ‚îÄ docker-compose.prod.yml
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOY.md
‚îÇ   ‚îú‚îÄ‚îÄ LOCAL_DEV.md
‚îÇ   ‚îú‚îÄ‚îÄ README.v2.md
‚îÇ   ‚îî‚îÄ‚îÄ TROUBLESHOOTING.md
‚îú‚îÄ‚îÄ pytest.ini
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ generate_openapi_json.py
‚îî‚îÄ‚îÄ wait-for-db.sh

````

---

## ‚öôÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

```bash
sudo apt update
sudo apt install -y python3.12-venv python3-pip git make
````

(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Docker –∏ Compose)

```bash
sudo apt install -y docker.io docker-compose-plugin
sudo usermod -aG docker $USER
newgrp docker
```

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
python3 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

---

## üîê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

`.env.example` –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `.env` –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è:

```dotenv
# === –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å SQLite ===
USE_SQLITE=1

# PostgreSQL (docker/prod)
POSTGRES_USER=admin
POSTGRES_PASSWORD=Admin@2025!
POSTGRES_DB=legal_assistant_db
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# JWT –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
SECRET_KEY=super_secret_key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# OpenAPI JSON
OPENAPI_JSON_PATH=docs/openapi.json

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=DEBUG
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### SQLite (—Ç–µ—Å—Ç—ã, –ª–æ–∫–∞–ª–∫–∞)

–°–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: `test.db`.

### PostgreSQL (docker/prod)

–ú–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Alembic:

```bash
alembic upgrade head
```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ API (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
make run
```

–ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ:

```bash
make run-bg
```

–î–æ—Å—Ç—É–ø:

* Swagger UI ‚Üí [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* Healthcheck ‚Üí [http://127.0.0.1:8000/api/health](http://127.0.0.1:8000/api/health)

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

### Dev

```bash
make docker
```

### Prod

```bash
make docker-prod
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
docker compose -f docker-compose.prod.yml down
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç SQLite (`test.db`).

### –ó–∞–ø—É—Å–∫

```bash
make test
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç

* ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å (`10 passed`).
* ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ—Ç **SQLAlchemy** (`Query.get`) –∏ **Pydantic** (`dict`/`Config`).

---

## ü§ñ CI/CD

CI (GitHub Actions):

* –ª–∏–Ω—Ç–µ—Ä—ã
* pytest (SQLite)
* –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI ‚Üí `docs/API_DOCS.md`

CD (—á–µ—Ä–Ω–æ–≤–∏–∫):

```bash
docker compose -f docker-compose.prod.yml up -d --build
```

---

## üìä –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

* –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ `server.log`.
* –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞: **Sentry** (–æ—à–∏–±–∫–∏), **Prometheus** (–º–µ—Ç—Ä–∏–∫–∏).

---

## üîê –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

* **admin** ‚Üí –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –±–∞–∑–æ–π.
* **lawyer** ‚Üí —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏, –∞–Ω–∞–ª–∏–∑, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.
* **client** ‚Üí –ø–æ–¥–∞—á–∞ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üî® Makefile (—É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã)

```makefile
run:        –∑–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ API
run-bg:     –∑–∞–ø—É—Å–∫ API –≤ —Ñ–æ–Ω–µ
test:       —Ç–µ—Å—Ç—ã (SQLite)
alembic:    –º–∏–≥—Ä–∞—Ü–∏–∏
docs:       –≥–µ–Ω–µ—Ä–∞—Ü–∏—è API-–¥–æ–∫–∏
docker:     –∑–∞–ø—É—Å–∫ docker-compose.yml
docker-prod:–∑–∞–ø—É—Å–∫ docker-compose.prod.yml
env-local:  –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ .env.local
env-prod:   –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ .env.prod
```

---

## üß® Troubleshooting

### –û—à–∏–±–∫–∞: –ø–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç

```bash
lsof -i :8000
kill -9 <PID>
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ —Ü–∏–∫–ª–µ

* –ü—Ä–æ–≤–µ—Ä—å `.env`
* –£–±–µ–¥–∏—Å—å, —á—Ç–æ `POSTGRES_DB=legal_assistant_db`
* –£–¥–∞–ª–∏ volume –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π:

```bash
docker compose -f docker-compose.prod.yml down -v
docker compose -f docker-compose.prod.yml up --build -d
```

### –û—à–∏–±–∫–∞: `psycopg2.OperationalError: connection refused`

* –ò—Å–ø–æ–ª—å–∑—É–π SQLite (`USE_SQLITE=1`)
* –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ Postgres –∑–∞–ø—É—â–µ–Ω.

---

## üõ£Ô∏è –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

* ‚úÖ CRUD (users, laws, decisions)
* ‚úÖ Healthcheck
* ‚úÖ –¢–µ—Å—Ç—ã (SQLite)
* ‚úÖ Docker (dev + prod)
* ‚úÖ CI (pytest + –∞–≤—Ç–æ–¥–æ–∫)
* ‚è© –ò–º–ø–æ—Ä—Ç –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑—ã
* ‚è© –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
* ‚è© –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram/CRM
* ‚è© –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑

---

## üõ† Git setup

–û–¥–∏–Ω —Ä–∞–∑ —É–∫–∞–∂–∏ –∏–º—è –∏ email (–ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub **noreply email**):

```bash
git config --global user.name "Aleksej Walz"
git config --global user.email "37653309+aw56@users.noreply.github.com"
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
git config --list | grep user
```

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:

```bash
git init
git add .
git commit -m "feat: initial commit with CRUD routes, tests, and docker setup"
```

---

## üîó –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π SSH-–∫–ª—é—á:

```bash
ssh-keygen -t ed25519 -C "alexejwalz@gmail.com"
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519
```

2. –°–∫–æ–ø–∏—Ä—É–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:

```bash
cat ~/.ssh/id_ed25519.pub
```

3. –î–æ–±–∞–≤—å –µ–≥–æ –≤ GitHub ‚Üí **Settings ‚Üí SSH and GPG keys ‚Üí New SSH key**.

4. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

```bash
ssh -T git@github.com
# Hi aw56! You've successfully authenticated
```

5. –î–æ–±–∞–≤—å remote:

```bash
git remote add origin git@github.com:aw56/legal-assistant-arbitrage-v2.git
git branch -M main
git push -u origin main
```

---

‚úÖ –¢–µ–ø–µ—Ä—å –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ Docker –∏ CI/CD.

```

---

–•–æ—á–µ—à—å, —è —Å—Ä–∞–∑—É –≤—ã–Ω–µ—Å—É —Ä–∞–∑–¥–µ–ª—ã **Git setup** –∏ **GitHub –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π `docs/GIT_SETUP.md`, –∞ –≤ README –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫—É—é —Å—Å—ã–ª–∫—É?
```
